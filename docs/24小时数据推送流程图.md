# 24å°æ—¶æ•°æ®æ¨é€æµç¨‹å›¾

## ğŸ“Š æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¤–éƒ¨æ•°æ®æº                                  â”‚
â”‚                  OKX WebSocket API                               â”‚
â”‚                                                                   â”‚
â”‚  æä¾›ï¼šTickerï¼ˆåŒ…å«24hä»·æ ¼ã€æ¶¨è·Œå¹…ã€äº¤æ˜“é‡ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ï¼‰    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ WebSocket æ¨é€ï¼ˆçº¦100ms-1sï¼‰
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              OkxMarketDataStreamProvider                         â”‚
â”‚                    (å®ç° IMarketDataStreamProvider)              â”‚
â”‚                                                                   â”‚
â”‚  åŠŸèƒ½ï¼š                                                          â”‚
â”‚  - è¿æ¥ OKX WebSocket                                           â”‚
â”‚  - è®¢é˜… Ticker é¢‘é“                                              â”‚
â”‚  - è§£æ JSON æ•°æ®                                                â”‚
â”‚  - è§¦å‘ OnTicker äº‹ä»¶                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ OnTicker äº‹ä»¶
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MarketDataStreamRelayService (åå°æœåŠ¡)                  â”‚
â”‚                                                                   â”‚
â”‚  åŠŸèƒ½ï¼š                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 1. æ¥æ”¶ MarketTicker æ•°æ®                            â”‚       â”‚
â”‚  â”‚    - symbol: "BTCUSDT"                              â”‚       â”‚
â”‚  â”‚    - price: 50000                                   â”‚       â”‚
â”‚  â”‚    - change24h: 0.0523 (5.23%)                      â”‚       â”‚
â”‚  â”‚    - volume24h: 1234567.89                          â”‚       â”‚
â”‚  â”‚    - high24h: 51000                                 â”‚       â”‚
â”‚  â”‚    - low24h: 48500                                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                          â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 2. æ•°æ®å»é‡ & é™æµ                                    â”‚       â”‚
â”‚  â”‚    - å“ˆå¸Œæ¯”å¯¹ï¼šé¿å…é‡å¤æ¨é€ç›¸åŒæ•°æ®                  â”‚       â”‚
â”‚  â”‚    - é™æµï¼šæœ€å°é—´éš” 1000ms                           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                          â”‚                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚           â†“                             â†“                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ 3a. å®æ—¶æ¨é€      â”‚         â”‚ 3b. å¼‚æ­¥æŒä¹…åŒ–    â”‚            â”‚
â”‚  â”‚ SignalR          â”‚         â”‚ åˆ°æ•°æ®åº“          â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                           â”‚
            â†“                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SignalRDataPushServiceâ”‚    â”‚   PriceDataService      â”‚
â”‚                       â”‚    â”‚                         â”‚
â”‚ PushPriceDataAsync() â”‚    â”‚ UpdateTradingPairPrice()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                         â”‚
            â”‚                         â†“
            â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚              â”‚   TradingPairs è¡¨     â”‚
            â”‚              â”‚                       â”‚
            â”‚              â”‚ UPDATE TradingPairs  â”‚
            â”‚              â”‚ SET Price = ...      â”‚
            â”‚              â”‚     Change24h = ...  â”‚
            â”‚              â”‚     Volume24h = ...  â”‚
            â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SignalR Hub                                  â”‚
â”‚                                                                   â”‚
â”‚  é¢‘é“ï¼šprice_BTCUSDT                                             â”‚
â”‚  äº‹ä»¶ï¼šPriceUpdate                                               â”‚
â”‚                                                                   â”‚
â”‚  æ¨é€æ•°æ®ï¼š                                                       â”‚
â”‚  {                                                                â”‚
â”‚    "symbol": "BTCUSDT",                                          â”‚
â”‚    "price": 50000.00,                                            â”‚
â”‚    "change24h": 0.0523,                                          â”‚
â”‚    "volume24h": 1234567.89,                                      â”‚
â”‚    "high24h": 51000.00,                                          â”‚
â”‚    "low24h": 48500.00,                                           â”‚
â”‚    "timestamp": 1729584000000                                    â”‚
â”‚  }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ WebSocket
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å‰ç«¯ (React)                                   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  signalRClient.ts                                  â”‚         â”‚
â”‚  â”‚                                                     â”‚         â”‚
â”‚  â”‚  - å»ºç«‹ WebSocket è¿æ¥                              â”‚         â”‚
â”‚  â”‚  - åŠ å…¥ç»„ï¼šJoinGroup('price_BTCUSDT')              â”‚         â”‚
â”‚  â”‚  - ç›‘å¬ï¼šconnection.on('PriceUpdate', handler)     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  useMergedTickerData.ts (React Hook)               â”‚         â”‚
â”‚  â”‚                                                     â”‚         â”‚
â”‚  â”‚  åŠŸèƒ½ï¼š                                             â”‚         â”‚
â”‚  â”‚  1. ä» localStorage æ¢å¤ç¼“å­˜                        â”‚         â”‚
â”‚  â”‚  2. è®¢é˜… PriceUpdate äº‹ä»¶                           â”‚         â”‚
â”‚  â”‚  3. åˆå¹¶å¤šä¸ªæ•°æ®æº                                  â”‚         â”‚
â”‚  â”‚  4. æ›´æ–° React State                                â”‚         â”‚
â”‚  â”‚  5. ä¿å­˜åˆ° localStorage                             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  UI ç»„ä»¶ (TradingPairInfo, TradingView, etc.)      â”‚         â”‚
â”‚  â”‚                                                     â”‚         â”‚
â”‚  â”‚  å±•ç¤ºï¼š                                             â”‚         â”‚
â”‚  â”‚  - å½“å‰ä»·æ ¼: $50,000.00                             â”‚         â”‚
â”‚  â”‚  - 24h æ¶¨è·Œ: +5.23% â†‘                              â”‚         â”‚
â”‚  â”‚  - 24h æœ€é«˜: $51,000.00                            â”‚         â”‚
â”‚  â”‚  - 24h æœ€ä½: $48,500.00                            â”‚         â”‚
â”‚  â”‚  - 24h é‡: 1,234,567.89 BTC                        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ—¶åºå›¾

```
æ—¶é—´  OKX API    Provider    Relay         SignalR      Database    Frontend
â”‚                                                                    
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚     
0ms   Ticker1 â”€â”€â†’
â”‚                OnTicker â”€â”€â†’
â”‚                            å»é‡/é™æµ â”€â”€â†’
â”‚                                        Push â”€â”€â†’
â”‚                                                Asyncâ”€â”€â†’
â”‚                                                         Update â”€â”€â†’
â”‚                                                         
100ms Ticker2 â”€â”€â†’                                        (ä¿å­˜ä¸­)
â”‚                OnTicker â”€â”€â†’                             
â”‚                            [å»é‡-è·³è¿‡]                   (å®Œæˆ)
â”‚                                                         
1000ms Ticker3 â”€â”€â†’                                       
â”‚                 OnTicker â”€â”€â†’
â”‚                            å»é‡/é™æµ â”€â”€â†’
â”‚                                        Push â”€â”€â†’
â”‚                                                Asyncâ”€â”€â†’
â”‚                                                         Update â”€â”€â†’
â”‚                                                                  
1100ms                                                             Render
â”‚                                                                  UIæ›´æ–°
```

## ğŸ“ å…³é”®ä»£ç ä½ç½®

### åç«¯ä»£ç 

| æ–‡ä»¶ | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| MarketTicker | `Domain/Entities/MarketData.cs` | æ•°æ®ç»“æ„å®šä¹‰ |
| IMarketDataStreamProvider | `Application/Abstractions/Services/MarketData/` | æä¾›è€…æ¥å£ |
| OkxMarketDataStreamProvider | `Infrastructure/ExternalServices/` | OKX å®ç° |
| MarketDataStreamRelayService | `Infrastructure/BgService/` | æ•°æ®ä¸­ç»§æœåŠ¡ |
| SignalRDataPushService | `Infrastructure/BgService/` | SignalR æ¨é€ |
| PriceDataService | `Infrastructure/Services/` | æ•°æ®æŒä¹…åŒ– |
| TradingPair | `Domain/Entities/` | æ•°æ®åº“å®ä½“ |

### å‰ç«¯ä»£ç 

| æ–‡ä»¶ | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| signalRClient.ts | `frontend/src/services/` | WebSocket å®¢æˆ·ç«¯ |
| useMergedTickerData.ts | `frontend/src/hooks/` | React Hook |
| types/index.ts | `frontend/src/types/` | TypeScript ç±»å‹ |
| TradingView.tsx | `frontend/src/pages/` | äº¤æ˜“é¡µé¢ |

## ğŸ¯ æ•°æ®æ ¼å¼å¯¹æ¯”

### 1. OKX åŸå§‹æ•°æ®ï¼ˆWebSocketï¼‰

```json
{
  "arg": {
    "channel": "tickers",
    "instId": "BTC-USDT"
  },
  "data": [{
    "instId": "BTC-USDT",
    "last": "50000",
    "lastSz": "0.1",
    "askPx": "50001",
    "bidPx": "49999",
    "open24h": "47500",
    "high24h": "51000",
    "low24h": "48500",
    "vol24h": "1234567.89",
    "volCcy24h": "6172839450",
    "ts": "1729584000000"
  }]
}
```

### 2. åç«¯ MarketTickerï¼ˆé¢†åŸŸå¯¹è±¡ï¼‰

```csharp
public record MarketTicker
{
    Symbol = "BTCUSDT",
    Last = 50000m,
    ChangePercent = 0.0526m,      // è®¡ç®—ï¼š(50000-47500)/47500
    Volume24h = 1234567.89m,
    High24h = 51000m,
    Low24h = 48500m,
    Ts = 1729584000000L
}
```

### 3. SignalR æ¨é€æ•°æ®

```json
{
  "symbol": "BTCUSDT",
  "price": 50000.00,
  "change24h": 0.0526,
  "volume24h": 1234567.89,
  "high24h": 51000.00,
  "low24h": 48500.00,
  "timestamp": 1729584000000
}
```

### 4. å‰ç«¯ MergedTickerData

```typescript
{
  symbol: "BTCUSDT",
  lastPrice: 50000.00,
  change24h: 0.0526,           // å°æ•°å½¢å¼
  volume24h: 1234567.89,
  high24h: 51000.00,
  low24h: 48500.00,
  timestamp: 1729584000000,
  _rawPrice: { /* åŸå§‹å¸§ */ },
  _rawTicker: { /* åŸå§‹å¸§ */ }
}
```

### 5. UI å±•ç¤ºæ ¼å¼

```
BTCUSDT
$50,000.00
+5.26% â†‘

24h æœ€é«˜: $51,000.00
24h æœ€ä½: $48,500.00
24h é‡: 1,234,567.89 BTC
```

## ğŸš€ æ€§èƒ½ç‰¹ç‚¹

### å»é‡æœºåˆ¶
```
æ•°æ®å“ˆå¸Œ = "50000|0.0526|1234567.89|51000|48500"
å¦‚æœå“ˆå¸Œç›¸åŒ â†’ è·³è¿‡æ¨é€ âœ…
```

### é™æµæœºåˆ¶
```
æœ€å°æ¨é€é—´éš”: 1000ms
å½“å‰æ—¶é—´ - ä¸Šæ¬¡æ¨é€æ—¶é—´ < 1000ms â†’ è·³è¿‡ âœ…
```

### å¼‚æ­¥æŒä¹…åŒ–
```
å®æ—¶æ¨é€ â†’ ç«‹å³å®Œæˆï¼ˆä¸ç­‰å¾…æ•°æ®åº“ï¼‰
æ•°æ®åº“æ›´æ–° â†’ Task.Run å¼‚æ­¥æ‰§è¡Œ âœ…
```

### å‰ç«¯ç¼“å­˜
```
localStorage.setItem('merged_ticker_cache_BTCUSDT', data)
é¡µé¢åˆ·æ–° â†’ ç«‹å³æ¢å¤ç¼“å­˜æ•°æ® âœ…
```

## ğŸ“Š æ•°æ®æ›´æ–°é¢‘ç‡

| å±‚çº§ | é¢‘ç‡ | è¯´æ˜ |
|------|------|------|
| OKX API | 100ms - 1s | å¤–éƒ¨æ•°æ®æºæ¨é€é¢‘ç‡ |
| Provider | å®æ—¶ | ç«‹å³è§¦å‘ OnTicker äº‹ä»¶ |
| Relay | æœ€å¿« 1s/æ¬¡ | é™æµä¿æŠ¤ï¼ˆå¯é…ç½®ï¼‰ |
| SignalR | å®æ—¶ | WebSocket æ¨é€ |
| Database | å¼‚æ­¥ | ä¸é˜»å¡å®æ—¶æ¨é€ |
| Frontend | å®æ—¶ | å“åº” WebSocket æ¶ˆæ¯ |

## ğŸ”§ é…ç½®é¡¹

### æ¨é€é—´éš”ï¼ˆåç«¯ï¼‰

```csharp
// MarketDataStreamRelayService.cs
const int TickerMinPushIntervalMs = 1000;  // 1ç§’

// è°ƒæ•´ä¸ºæ›´å¿«æ›´æ–°
const int TickerMinPushIntervalMs = 500;   // 0.5ç§’

// è°ƒæ•´ä¸ºå‡å°‘è´Ÿè½½
const int TickerMinPushIntervalMs = 2000;  // 2ç§’
```

### è®¢é˜…äº¤æ˜“å¯¹

```csharp
// MarketDataStreamRelayService.cs
private readonly string[] _symbols = new[] { 
    "BTCUSDT", 
    "ETHUSDT", 
    "SOLUSDT" 
};
```

### æ•°æ®æ¥æºåˆ‡æ¢

```csharp
// Program.cs
// ä½¿ç”¨ OKX
builder.Services.AddSingleton<IMarketDataStreamProvider, OkxMarketDataStreamProvider>();

// æˆ–ä½¿ç”¨ Binance
builder.Services.AddSingleton<IMarketDataStreamProvider, BinanceMarketDataStreamProvider>();
```

## ğŸ› è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹å®æ—¶æ—¥å¿—

```bash
# æŸ¥çœ‹ Ticker æ¨é€æ—¥å¿—
tail -f logs/app.log | grep "Ticker Relay"

# æŸ¥çœ‹æ•°æ®åº“æ›´æ–°æ—¥å¿—
tail -f logs/app.log | grep "ä»·æ ¼æŒä¹…åŒ–"
```

### å‰ç«¯è°ƒè¯•

```typescript
// æŸ¥çœ‹åŸå§‹æ•°æ®å¸§
const { data } = useMergedTickerData('BTCUSDT');
console.log('Raw Price:', data?._rawPrice);
console.log('Raw Ticker:', data?._rawTicker);

// æ£€æŸ¥ç¼“å­˜
const cached = localStorage.getItem('merged_ticker_cache_BTCUSDT');
console.log('Cached:', JSON.parse(cached || '{}'));

// æ£€æŸ¥è¿æ¥çŠ¶æ€
console.log('SignalR Connected:', signalRClient.isConnected());
```

### æ•°æ®åº“æ£€æŸ¥

```sql
-- æŸ¥çœ‹æœ€æ–°ä»·æ ¼æ•°æ®
SELECT 
    Symbol, 
    Price, 
    Change24h, 
    Volume24h, 
    High24h, 
    Low24h,
    FROM_UNIXTIME(LastUpdated/1000) AS LastUpdate
FROM TradingPairs 
WHERE Symbol = 'BTCUSDT';

-- æŸ¥çœ‹æ›´æ–°é¢‘ç‡
SELECT 
    Symbol,
    COUNT(*) as UpdateCount,
    MAX(FROM_UNIXTIME(LastUpdated/1000)) as LatestUpdate
FROM TradingPairs 
GROUP BY Symbol;
```

## âœ… éªŒè¯æ¸…å•

- [ ] OKX WebSocket è¿æ¥æˆåŠŸ
- [ ] Provider æ”¶åˆ° Ticker äº‹ä»¶
- [ ] Relay Service æ­£å¸¸è¿è¡Œ
- [ ] SignalR æ¨é€åˆ°å‰ç«¯
- [ ] æ•°æ®åº“æ­£ç¡®æ›´æ–°
- [ ] å‰ç«¯æ˜¾ç¤ºå®æ—¶æ•°æ®
- [ ] ç¼“å­˜æœºåˆ¶å·¥ä½œæ­£å¸¸
- [ ] å»é‡æœºåˆ¶ç”Ÿæ•ˆ
- [ ] é™æµæœºåˆ¶ç”Ÿæ•ˆ
- [ ] æ—¥å¿—è®°å½•å®Œæ•´

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [24å°æ—¶æ•°æ®æ¨é€æµç¨‹è¯¦è§£.md](./24å°æ—¶æ•°æ®æ¨é€æµç¨‹è¯¦è§£.md) - å®Œæ•´æŠ€æœ¯æ–‡æ¡£
- [æˆäº¤æ¨é€é€»è¾‘è¯¦è§£.md](./æˆäº¤æ¨é€é€»è¾‘è¯¦è§£.md) - æˆäº¤æ¨é€è¯´æ˜
- [è®¢å•æ’®åˆé€»è¾‘è¯´æ˜.md](./è®¢å•æ’®åˆé€»è¾‘è¯´æ˜.md) - æ’®åˆé€»è¾‘è¯´æ˜
